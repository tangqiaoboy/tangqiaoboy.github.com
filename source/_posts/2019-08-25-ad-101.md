---
title: 效果广告基础 - 兼读《计算广告》
date: 2019-08-25 22:00:56
categories: summary
tags: books
---


## 广告的类型

广告收入撑起了中国互联网行业收入的半壁江山，本质上百度、阿里、头条系的大部分收入，都是来自广告。腾讯虽然游戏收入很多，但广告收入也不少。

而广告的类型，我个人理解主要分为：品牌广告 和 效果广告。

品牌广告不容易直接计算广告的效果。比如今年猿辅导与《最强大脑》节目合作，在节目中做一些宣传，就属于品牌广告。其部分效果虽然可以从节目播出前后的下载量变化看到，但是对消费者更长期的口碑和心智影响却不容易评估。

效果广告与品牌广告相反，它直接以转化效果来计算费用。广告主可以设定具体的转化目标（例如：App 激活、用户付费、用户注册等），然后就可以为此目标进行出价，广告平台通过竞价的方式最终完成相应的广告投放。

搜索广告属于效果广告的一种，不过需要与用户的搜索行为相配合。用户搜索一个关键词的行为，表现出对相关广告极高的了解欲望，这个时候的广告转化的效果就非常好。这类广告都引入了竞价排名的机制，使得广告位的价值通过竞价达到最大。搜索广告主要提供者是百度和 Google 这类搜索引擎产品。

除了搜索广告，展示类效果广告也非常多。比如我们在各种信息流，例如：微信朋友圈、微博、今日头条、抖音里看到的广告，就属于展示类的效果广告。在本文中，我主要展开讨论这一类效果广告。

## 品牌广告的效果

效果广告与品牌广告，本质上都是要评估效果的。只是品牌广告的效果不直接，不容易评估，但是不代表品牌广告不需要评估效果。从长远看，品牌广告的资金投入，最终都应该转化到获客成本上，最终可以计算出这些广告的价值。只是相对来说，这些计算不太容易。

百货业之父约翰·沃纳梅克说过一句话：“我知道有一半广告费浪费了，但我不知道是哪一半”。讲的就是品牌广告相对来说不好评估效果的困境。

## 效果广告中的角色

为了大家理解各种角色，我给大家讲一个拍电影的故事。

我们假设你是导演，要拍一个有关效果广告的电影。

你写了一个最简单的人物剧本，要做效果广告显然需要两个角色：

 * 广告主：负责花钱打广告的。
 * 广告平台：负责卖广告位的。

广告主为了打广告，他的团队需要有投放主管、渠道经理、产品技术团队，内容创意团队：

 * 投放主管算是广告投放工作的负责人，进行工作的统筹并为结果负责。
 * 渠道经理是某一个或几个广告平台渠道的专家，负责相关的广告平台的投放工作。
 * 产品技术团队负责为投放工作做相应的广告页面开发，相关的支撑系统和数据分析。
 * 内容创意团队用于构思和制作广告创意。

而广告平台，通常有销售经理、运营经理、产品技术团队：

 * 销售经理面向潜在的客户，推销自己的广告平台，不断为平台带来新的客户。
 * 运营经理对接广告主，为广告主答疑解惑，提供投放相关的知识经验。
 * 产品技术团队负责搭建和维护广告投放相关的系统。

## 代理商

剧本写到这里，扮演广告平台的几个演员不干了。他们说：我们对接的全中国的广告主有上万家，这么多广告主我们怎么照顾得过来？而且这些广告主是给钱的金主，他们提各种需要我们又不好拒绝，应该怎么办？

这个时候，一个跑龙套的过来说：要不我来替你们干这些脏活累活吧！于是，你在剧本中加了一个角色：代理商。

大的广告平台为了保证自身的团队规模的精简，同时剥离那些偏服务性质的脏活累活，于是将自己的广告业务，完全交给一家或多家代理商来进行二次售卖。广告平台以「返点」的方式，将广告费用的一定比例，支付给代理商作为报酬。

代理商内部通常的角色有：

 * 销售经理。面向潜在的客户，推销自己代理的广告平台。
 * 运营经理。与广告主的渠道经理配合，为其提供各种服务。
 * 内容创意团队。与广告主的渠道经理配合，为其制作各种内容创意。

平台对代理商的资金消耗通常要求比较高，有一些代理商规模比较小，但是自己又有自己独到的一技之长（比如销售能力），于是这些小规模的代理商就会找大的代理商拿量，这就是二级代理商。

这样就形成了，一级代理商负责与平台对接，承诺比较大的广告投放量，二级代理商具体服务各个广告主，为一级代理商贡献投放量。最终一级代理商和二级代理商分享平台的「返点」的服务模式。

代理商除了使得广告平台的对接压力减小外，同时也承担了更加专业的广告投放任务。因为很多小的广告主其实是没有能力制作广告并有技巧地投放的，这个时候代理商就可以承担从脚本提供、到素材制作、再到投放测试的一条龙服务。

我画了一个广告主（蓝色）、代理商（红色）、广告平台（绿色 + 黄色）的沟通操作示意图。

{% img /images/ad-101-3.png %}

广告主的渠道经理主要和代理商的渠道经理对接，共同通过操作广告平台的投放系统，来完成广告的投放。在这个过程中，广告平台的运营经理，会特别关照一些大的投放客户。

## 广告平台与 oCPM

广告平台有很多，比如：微信、广点通、头条、百度、喜马拉雅、微博。

广告平台其实目标只有一个，就是最大化自己的收益。那么广告平台如何最大化自己的收益呢？我们来看一个公式：

`总收益 = 广告总流量 x 流量填充率 x 每次曝光价格（eCPM）`

根据这个公式，广告平台要提高收益，主要有 3 个办法：

 - 增加广告位。这样就增加了广告总流量。但是这伤害了用户体验，不能无限制地增加。
 - 提高广告填充率。广告的填充率影响很多，既有广告主的数量，又有当前广告平台相比别的平台的价格优势，还有算法的影响。
 - 提高单位广告位价格，即提高 CPM（Cost Per Thousand ）。但因为广告平台之间也要竞争，所以如果过高，则会流失部分广告主，影响广告填充率。

广告平台在最初的时候，就是简单地按 CPM 来让大家出价，出价高的人就可以获得广告位。这里面涉及的竞价算法（广义第二高价），我稍后再介绍。

但是广告平台很快发现了问题：单纯地选出价高的广告主来投放，对平台或许不是最优的。因为短期出价高的广告主，对于平台来说长期收益不一定是最大的。比如：出价最高的广告可能转化率低，自身无法长期承受这个价格。

于是，Facebook 在几年前提出 oCPM 的计费规则，前面那个 o，指 Optimized。在 oCPM 规则下，平台不止考虑你的出价，也要考虑你设置的那个优化（Optimized）目标。

不同的广告主的优化目标可能不一样，如果是投放 App 下载的广告主，优化目标可能是 App 的激活。如果是电商平台，优化目标可能是成单。设置好了优化目标，广告平台就会根据目标和你的出价范围，来动态地调整出价策略。

本质上，oCPM 是一种替客户考虑的计费方式，广告平台不止收你的钱，还会替你考虑转化的成本和效率。如果成本过高，广告平台就直接不花你的钱了。短期来看，可能会少挣了一些钱，但是长久来看，广告平台可以吸引更多广告主过来。

## eCPM

当 oCPM 变得更科学和动态之后，广告平台就利用 eCPM 来进行竞价了。eCPM 本质上是站在广告平台角度，看每个广告位带来的预期收益是多少。在腾讯的微信朋友圈广告投放 [官方文档](https://wximg.qq.com/wxp/wxadtouch/upload/t2/file-1512718899454.pdf) 上，我们可以看到 eCPM 的计算公式是：

{% img /images/ad-101.jpg %}

所以，eCPM 其实就是结合了出价、转化概率、以及智能调价因子而算出来的平台可以在某个广告位上挣到的钱。eCPM 只是一个竞价模型，平台按这个来评估每个广告的价值，选最高的来进行展示。但是 eCPM 并不代表广告主的出价，也不代表平台真正能收到的钱。对于广告主来说，其实计费方式还是按曝光次数收费。只是对于 eCPM 值低的广告主，他的广告可能永远也无法得到展示。

为了让大家更容易理解 eCPM ，我给大家讲一个地主的故事。假设你是一个地主，你想把你的地租给一户人家种，于是来了四户人家：

 * 第一户人家，出价最高，但是他把地租下来，其实是想种毒品。你担心他过两天就被警察叔叔抓走了，你收不到多少钱不说，可能还会承担连带责任。
 * 第二户人家，出价次高。但是这个人其实很傻，他没有仔细算帐。你帮他算了一下帐，按他现在付的租金，回头他收完庄稼，应该是入不敷出的。你想了想，第二年要不他就被饿死了，要么他就觉得你是黄世仁，起义把你抄家了。长远来看也不好。
 * 第三户人家，出价第三。租你地是为了种高价值的水果，这种人家年轻力壮，家里人又团结齐心。果树价值高，种好了能够收成好多年。你算了算，他们是可以挣钱的。
 * 第四户人家，出价最低。租你地是为了种粮食，附加价低，所以他出不起高价钱。

好了，问题来了，如果你是地主，你应该租给哪家人？你仔细想了想，租给了第三户人家，因为长远来看，第三户人家收入稳定，也最安全，你的长远收益最大。例子中的第 1，2 户人家，他们的「智能调价因子」起了作用，所以使得他们的出价虽然高，但最后的 eCPM 值低于第三户人家。


## 广告的计价算法

广告平台通常采用的计价算法是广义第二价格 GSP（Generalized Second Price）。为了让大家理解这个算法，我们还是需要再讲个故事。

好了，你又开始当地主了。现在有两户人家想租你的地，你发现他们的条件都挺不错的，于是你就说，要不咱们公开拍卖吧。于是这两户人家就开始出价：

 * A: 1 毛
 * B: 2 毛
 * A: 3 毛
 * B: 4 毛
 * A: 5 毛
 * B: .....

于是，经过了一整天的竞价，价格终于涨到了 2 块钱，而最终成交价可能是 1000 块。所以，问题一出来了：出价者希望试探对方的低价，造成提价过程过于缓慢。

第二年，你又遇到了同样的问题，于是你换了一个做法：每个人只能出一次价格，把价格装在信封里面，出完就再成不能变了。于是，A 的信封里面出了 900 块，B 的信封里面出了 500 块。A 成交。但是！A 很不开心！他觉得他亏了 400 块！问题二：出价格希望用最低可能的成交价成交。

广义第二价格解决了上面两个问题，简单来说，双方还是可以随便出价，但是成交价格按第二高价，再加上一个极小值来结算。拿上面的例子来说，你就可以给大家说，大家可以随时给我出价，我会按照第二高价加 0.01 元来收取最终成交者的费用。如果 A 出 900 元，B 出 500 元，那么最终成交的人是 A，成交价是 B 的价格加上 0.01 元，即 500.01 元。

同时，规则规定 B 不知道 A 的出价，B 首先无法在 A 的价格上简单加一个最小值来竞价。另外，因为第二高价的原因，B 在行为上也不需要这么做，B 完全可以出一个他能承受的最高价，反正最后结算的时候，并不以这个价格来结算。

小结：广义第二价格使得竞价方的每一个人都有动力直接把价格出到自己能够接受的底线。知乎上 [这篇贴子](https://www.zhihu.com/question/266362314)，对此有更多的介绍。


## 角色与角色之间的关系

你还记得我们假设你是电影导演，要拍电影么？现在角色定好了，世界观也定了。

当你把三个角色（广告主、广告平台、代理商）和世界观（ oCPM 出价，eCPM 竞价，广义第二高价结算）都定下来之后，才发现人物关系其实一点都不简单。

这也是大部分电影最有意思的部分。


### 广告主与广告平台

广告主花钱打广告，广告平台挣广告的钱，给广告主带来效果。看起来是一个双赢，但是，广告平台本质上是希望它尽可能的多挣钱。所以，现在你来想像这样一个场景：如果广告平台发现，他的某一个广告主因为某个行业特别好挣得多，可以出 1000 块的钱来打广告，但是现在平台第二高价只花掉了广告主 500 块。

因为这个广告主其实花得起 1000 块，广告平台会不会想办法，把这个广告主的成本提到 1000 块？

有人会问：有什么办法呢？整个广告竞价模型其实都是黑箱的，广告平台告诉你第二高价是 999，你其实也没办法说它作弊。

上面这个说得还算简单，说得复杂点，现在推荐算法和深度学习这么强，广告系统有没有办法学习到每个广告主对于价格忍受的底限？能不能在保证广告主不亏本的情况下，尽可能地把广告主的利润全部拿走？

我听说，某广告平台内部甚至都有刷量的团队存在。在巨大的经济利益面前，把刷量团队升级成更智能的算法，这并不是一个本质上的改变。

有人说平台黑，其实反过来也一样，所有人都想知道广告平台的算法是否有漏洞或者什么规律，因为如果你知道了，就可以根据这个规律做一些特别的优化，这个本质上和搜索引擎的 ASO 是一个道理。所以，如果你在一家广告平台写竞价算法，很容易会有人找上门来，希望你透露一些算法上的细节。对于广告平台来说，这何尝不是一个风险？

### 广告主与代理商

代理商看起来只是挣返点的钱。但是其实情况比这个复杂得多。

首先，代理商之间是有竞争的，为了赢得投放额，代理商之间不但要比拼投放的效果，服务的效果，也要比拼和甲方的关系。这里面其实是极容易出现腐败的。我知道有一家创业公司，广告主一方的 CEO 就这样拿了不少代理商的回扣。

然后，代理商哪有什么竞争壁垒，你说你好不容易研究出一个创新的投放素材，这个行业又没有什么专利，分分钟就被各家抄去了，根本就保密不了。广告平台甚至还会定期给全行业同步各种好的广告创意。

本质上，代理商就是一个重服务，壁垒极低的服务行业，生存压力大，那为了竞争活下来，代理商其实也会走捷径。什么是捷径？这就是刷量。

刷量的本质是：广告投放的成本与商品本身的价格错位。比如一个商品，本来卖 5 块钱，但是广告费用可能是 10 块。之所以有这样的行为，是因为广告主看重了更多的远期价值，比如这个用户未来还会复购，还会带来品牌和口碑等等。

因为有这样的错位，代理商其实就有动力刷量了。因为他只需要花少量的钱，就可以刷出比较好的转化率，进而可以获得更多的广告投放额度，获得更多的返点。

某个比较大的代理商给我说：刷量在代理商行业里面是潜规则，只是分刷得厉害还是不厉害。刷得厉害的，被发现了，就被广告主拉黑了，所以做长期生意的代理商，就少刷点量，工作也做，于是广告主也搞不明白刷没刷。

为了应对代理商的刷量，广告主一定要保守住自己的核心数据指标和反作弊策略。因为现在刷量的行为已经很高级了，不但可以给你刷下载和成单，也还可以给你刷留存和活跃。

上次听到一个故事，有一个游戏公司，发现用户只要留存下来，未来半年人均花费 50 元，于是他们就按留存率来做投放。在投放的时候发现某个渠道留存率明显很高，还以为用户属性比较 Match，以为捡到了宝。进一步加大了投放。结果后来这些用户留存率虽然没问题，但是就是不消费，游戏公司因此亏了不少钱。

像这种坑就很麻烦，因为你要检查效果需要时间，而投放行为又不能等。一些 App 下载类的投放也有类似的问题。你如果检查日活，留存什么的，刷量的公司都可以给你做出来，如果是投放新手，分分钟被坑死。

所以，在效果广告领域，广告主的反作弊能力的高低，直接关系到公司的成败。

### 代理商与广告平台

代理商与广告平台的利益冲突相对小，因为代理商是收的广告主钱，广告平台也是收的广告主钱。广告平台相对来说，只是希望代理商不要把素材做太烂，影响平台的用户体验。所以广告平台一方面会有素材的审核，另一方面也会奖励高品质的素材。

### 随机性

广告素材效果的随机性是一个不得不说的特点，每个广告素材在投放之前，都会用一个小的量进行测试。但是因为这个量太小，所以很容易出现一些随机性，使得你无法判断素材的好坏，而初使的数据如果糟糕，也会影响广告系统的预测算法，使得之后这个素材更难以获得曝光。因为广告展示都需要花钱，你又舍不得花更多的钱进行测试，只能放弃。

这种随机性使得广告投放需要进行大量的素材测试，而跑出一个效果奇好的「超级素材」，既需要创意，也需要运气。

而就算你有了一个超级素材，因为市场同行的大量跟进，以及观众对素材新鲜度的偏好，你的这个素材也无法长期使用。

于是，广告主和代理商只能一遍一遍的尝试新的素材，永无止境。

而超级素材的随机性，又使得这个事情很难迭代总结，一切都是命。

## 广告的竞价

在 [《RTB 广告竞价系统的算法介绍》](https://dolantinlist.github.io/2018/05/21/RTB%E5%B9%BF%E5%91%8A%E7%AB%9E%E4%BB%B7%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%AE%97%E6%B3%95%E4%BB%8B%E7%BB%8D/) 一文中，我们可以广告竞价的一个关系图：

{% img /images/ad-101-2.png %}


具体流程如下：

  1. 用户使用浏览器访问这个 web 页面 , 此时产生出了一个曝光展示。
  2. 媒体将广告位展示信息通过 SSP 传递给 Ad Exchanges。
  3. Ad Exchanges 对多家与之对接的 DSP 发送竞价请求。
  4. DSP 通过 DMP 数据管理平台或自身的用户数据库来推断用户属性, 通过 DSP 的竞价引擎判断是否参与竞价 , 若参与则给出竞标价格。
  5. DSP 将竞价响应传递给 Ad Exchanges。
  6. Ad Exchanges 接收到所有 DSP 的响应或到达截止时间 (通常规定是 100ms），确定获胜的 DSP。
  7. Ad Exchanges 通知 SSP 竞拍的赢家 ,SSP 发送广告曝光请求给广告服务器。
  8. 广告服务器将广告投送到用户浏览的 web 页面。
  整个过程对于用户体验来说几乎是瞬间完成的 , 当打开网页即可看到对应的广告。

这里面比较难的一个是实时性，因为广告要求极端的时间（通常小于 100 毫秒）决定获胜的广告主。另一个比较难的就是预测，广告的 eCPM 是估计出来的，这里面通常是多个模型的叠加作用，出了问题要查起来都非常复杂。

我也不是这方面的专家，所以这部分我就不详细展开了。

## 小结

 * 效果广告的三大角色：广告主、广告平台、代理商。

 * 效果广告的三大世界观：oCPM 出价，eCPM 竞价，广义第二高价结算。

 * 人性和利益不统一，是效果广告中最难解决的部分，广告主要做好廉洁管理和反作弊策略，保护好自己的底价以及核心数据。

 * 随机性是广告素材不得不面对的情形，一切都是命。


本文有部分内容也参考了计算广告专家刘鹏老师的《计算广告》一书，算是今年读的第 13 本书吧。

